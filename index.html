<!doctype html><html lang="en" prefix="og: https://ogp.me/ns/">
<head>
	<meta charset="utf-8">
	<link rel="preconnect" href="https:/ajax.googleapis.com">
	<link rel="preconnect" href="https:/fonts.googleapis.com">
	<link rel="preconnect" href="https:/fonts.gstatic.com" crossorigin>
	<noscript><style>html{display:none;}</style></noscript>
	<meta charset="UTF-8" />
	<meta name="viewport" content = "width=device-width, initial-scale=1" />
	<meta name="color-scheme" content="light dark" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<link rel="stylesheet" href="styles.css">
	<link rel="shortcut icon" href="css/favicon.ico" />
	<link rel="apple-touch-icon" href="css/apple-touch-icon.png">
</head>

<body>
    <form id="searchform" action="#">
        <input id="searchFor" type="search" placeholder="Search ... [enter Job ID or keywords]" autofocus autocomplete="off"><br>
		<div id="coding" class="hintHelp"></div>
		<span id="hintHelper"></span><button type="button" id="hintFirst" class="hintResults hintResultsFirst" value="first"><button type="button" id="hintSecond" class="hintResults"><button type="button" id="hintThird" class="hintResults" >
    </form>
	
	<script>
		$(document).ready(function() {
		
			$('#hintFirst').click(function() {selectHint(this.id);})
			$('#hintSecond').click(function() {selectHint(this.id);})
			$('#hintThird').click(function() {selectHint(this.id);})
	
		});


		$('#searchform').submit(function(e) {
			e.preventDefault();
			var sf = $('#searchFor').val().trim();
			if(sf.indexOf(' ') != -1) {
			// multi search

				sf=sf.split(' ').toString(); // convert from space seperated list to comma seperated list

			} else {
			// single search
				
			}

			$.ajax({type:"POST", url: "search.php", data: 'f='+ sf, 
				success: function(thisText){
					var hints = JSON.parse(thisText);
					var showResults="";
					for(i=0;i<hints.length;i++){
						showResults = showResults + ' ' + hints[i].name;
					}
					hideHints();
					$('#coding').html(showResults); // hints[0].name + " : " + hints[1].name);
				},
				error: function(thisText) {
					searchError();
				}
			});

		});
	
		$('#searchFor').keyup( function(e) {
		
			if(e.key === ' ') {
				if($('#hintFirst').html() != '') selectHint('hintFirst');
			} 
			var typed = $(this).val();

			if(typed != '') {
				hideHints();
				var getLastWord = typed.split(' ');
				if(getLastWord[getLastWord.length-1].trim() != '') {
					$.ajax({type:"POST", url: "search.php", data: 's='+ getLastWord[getLastWord.length-1], 
						success: function(thisText){
							var hints = JSON.parse(thisText);
							if(hints.length) {
								if(hints.length>0) showHints('hintFirst',hints[0].name);
								if(hints.length>1) showHints('hintSecond',hints[1].name);
								if(hints.length>2) showHints('hintThird',hints[2].name);
							} else {
								searchError();
							}
						},
						error: function(thisText){
							searchError();
						}
					});
				}
				
			} else {
			
				hideHints();
				
			}

		});
		
		function selectHint(btnName) {
		
			
			var hint = $('#'+btnName).html();
			var searchForText = $('#searchFor').val();
			var searchFor = searchForText.split(' ');
			if(searchForText.slice(searchForText.length-1) === ' ') searchFor.pop();
			searchFor[searchFor.length-1]=hint;
			$('#searchFor').val(searchFor.join(' ')+' ').focus();
		
		}
		
	
		function searchError() {
		
			$('#coding').html('Nothing found for those search terms.');
			
		}
	
		function showHints(where,what) {
		
			$('#'+where).show().html(what);
			$('#coding').hide().html("");

		}
		
		function hideHints() {
		
			$('#hintFirst').hide().html();
			$('#hintSecond').hide().html();
			$('#hintThird').hide().html();
			$('#coding').show().html("Start typing, press 'Space' to auto-complete, 'Enter' to select.");

		}
		
	</script>
	
</body>
</html>
